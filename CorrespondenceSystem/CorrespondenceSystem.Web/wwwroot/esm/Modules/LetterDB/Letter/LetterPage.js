import{a as w,b as G,d as N}from"../../../_chunks/chunk-SHKIMZOM.js";import{a as b,b as A,d as U}from"../../../_chunks/chunk-W2A6TYLC.js";import{a as q}from"../../../_chunks/chunk-EAAQUTWP.js";import{c as o,f as i,g as m,i as n}from"../../../_chunks/chunk-THKE7DQS.js";var j=i(n(),1);var T=i(n(),1);var H=i(n(),1),C=(e=>(e[e.Draft=0]="Draft",e[e.Posted=1]="Posted",e[e.Received=2]="Received",e))(C||{});H.Decorators.registerEnumType(C,"CorrespondenceSystem.Modules.Enums.Letter.States","State");var D=class D extends T.ColumnsBase{};o(D,"LetterColumns"),D.columnsKey="LetterDB.Letter",D.Fields=(0,T.fieldsProxy)();var E=D;var K=i(n(),1),O=i(q(),1);var l=class extends O.GridEditorBase{getColumnsKey(){return w.columnsKey}getDialogType(){return N}getLocalTextPrefix(){return G.localTextPrefix}};o(l,"LetterAttachmentEditor"),l=m([K.Decorators.registerEditor("CorrespondenceSystem.LetterAttachmentDB.LetterAttachmentEditor")],l);var c=i(n(),1),k=i(q(),1);var p=class extends k.GridEditorBase{getColumnsKey(){return b.columnsKey}getDialogType(){return U}getLocalTextPrefix(){return A.localTextPrefix}AddSign(){(0,c.serviceCall)({url:(0,c.resolveUrl)("~/Services/SignLettersDB/SignLetters/AddSignLetter"),onSuccess:a=>{var t=this.view.getItems();let e={SignTitle:a.Title,SignId:a.Id,CreatedDate:a.CreatedDate};var S=this.id(e);S==null&&(e[this.getIdProperty()]=this.getNextId()),t.push(e),this.setEntities(t)},method:"post"})}getButtons(){var a=super.getButtons(),t=(0,c.tryFirst)(a,e=>e.cssClass=="add-button");if(t){let e=!0;t.onClick=S=>{e&&(this.AddSign(),e=!1,t.disabled=!0)}}return a}};o(p,"SignLettersEditor"),p=m([c.Decorators.registerEditor("CorrespondenceSystem.SignLettersDB.SignLettersEditor")],p);var r=i(n(),1);var J=i(n(),1),B=(t=>(t[t.Normal=0]="Normal",t[t.Secret=1]="Secret",t))(B||{});J.Decorators.registerEnumType(B,"CorrespondenceSystem.Modules.Enums.Letter.ConfidentialLevels","ConfidentialLevels");var M=i(n(),1),I=(t=>(t[t.Outgoing=0]="Outgoing",t[t.Incoming=1]="Incoming",t))(I||{});M.Decorators.registerEnumType(I,"CorrespondenceSystem.Modules.Enums.Letter.LetterTypes","LetterTypes");var Q=i(n(),1),P=(e=>(e[e.Urgent=0]="Urgent",e[e.Instant=1]="Instant",e[e.Normal=2]="Normal",e))(P||{});Q.Decorators.registerEnumType(P,"CorrespondenceSystem.Modules.Enums.Letter.PriorityStates","PriorityState");var g=class g extends r.PrefixedContext{constructor(a){if(super(a),!g.init){g.init=!0;var t=r.RadioButtonEditor,e=r.StringEditor,S=r.EnumEditor,R=r.ServiceLookupEditor,y=r.BooleanEditor,z=r.LookupEditor,W=r.TextAreaEditor,Y=l,Z=p;(0,r.initFormType)(g,["LetterType",t,"Title",e,"LetterIdentifier",e,"LetterIdentifierGen",e,"LetterNo",e,"PriorityState",t,"ConfidentialLevel",t,"State",S,"SenderId",R,"ReceiverId",R,"GrandSubjectId",R,"UseDefaultTemplate",y,"TemplateId",z,"LetterContent",W,"Tag",e,"LetterCarrier",e,"HasAttachment",y,"NeedAnswer",y,"DetailList",Y,"SignLettersDetailList",Z])}}};o(g,"LetterForm"),g.formKey="LetterDB.Letter";var x=g;var F=i(n(),1);var d=class d{};o(d,"LetterRow"),d.idProperty="Id",d.nameProperty="LetterIdentifier",d.localTextPrefix="LetterDB.Letter",d.deletePermission="Administration:General",d.insertPermission="Administration:General",d.readPermission="Administration:General",d.updatePermission="Administration:General",d.Fields=(0,F.fieldsProxy)();var L=d;var X=i(n(),1),v;(t=>(t.baseUrl="LetterDB/Letter",t.Methods={Create:"LetterDB/Letter/Create",Update:"LetterDB/Letter/Update",Delete:"LetterDB/Letter/Delete",Retrieve:"LetterDB/Letter/Retrieve",List:"LetterDB/Letter/List",SetDefaultRecriverSender:"LetterDB/Letter/SetDefaultRecriverSender"},["Create","Update","Delete","Retrieve","List","SetDefaultRecriverSender"].forEach(e=>{t[e]=function(S,R,y){return(0,X.serviceRequest)(t.baseUrl+"/"+e,S,R,y)}})))(v||(v={}));var h=i(n(),1);var s=i(n(),1);var u=class extends s.EntityDialog{constructor(){super(...arguments);this.form=new x(this.idPrefix)}getFormKey(){return x.formKey}getRowDefinition(){return L}getService(){return v.baseUrl}afterLoadEntity(){this.SetRecriverSender()}SetRecriverSender(){(0,s.serviceCall)({url:(0,s.resolveUrl)("~/Services/LetterDB/Letter/SetDefaultRecriverSender"),onSuccess:t=>{t?this.form.LetterType.changeSelect2(e=>{if(this.form.LetterType.value==1 .toString()&&(s.EditorUtils.setValue(this.form.ReceiverId,t),s.EditorUtils.setValue(this.form.SenderId,null)),this.form.LetterType.value==0 .toString()){var S=this.SetRecriverSender();s.EditorUtils.setValue(this.form.SenderId,t),s.EditorUtils.setValue(this.form.ReceiverId,null)}}):console.error("Invalid response format for SetDefaultRecriverSender")},method:"post"})}};o(u,"LetterDialog"),u=m([s.Decorators.registerClass("CorrespondenceSystem.LetterDB.LetterDialog")],u);var f=class extends h.EntityGrid{getColumnsKey(){return E.columnsKey}getDialogType(){return u}getRowDefinition(){return L}getService(){return v.baseUrl}constructor(a){super(a)}};o(f,"LetterGrid"),f=m([h.Decorators.registerClass("CorrespondenceSystem.LetterDB.LetterGrid")],f);function _(){(0,j.initFullHeightGridPage)(new f($("#GridDiv")).element)}o(_,"pageInit");export{_ as default};
//# sourceMappingURL=LetterPage.js.map
