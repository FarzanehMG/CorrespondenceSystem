import{a as w,b as G,d as N}from"../../../_chunks/chunk-SHKIMZOM.js";import{a as b,b as q,d as U}from"../../../_chunks/chunk-W2A6TYLC.js";import{a as A}from"../../../_chunks/chunk-EAAQUTWP.js";import{c as i,f as n,g as m,i as s}from"../../../_chunks/chunk-THKE7DQS.js";var V=n(s(),1);var E=n(s(),1);var O=n(s(),1),D=(e=>(e[e.Draft=0]="Draft",e[e.Posted=1]="Posted",e[e.Received=2]="Received",e))(D||{});O.Decorators.registerEnumType(D,"CorrespondenceSystem.Modules.Enums.Letter.States","State");var x=class x extends E.ColumnsBase{};i(x,"LetterColumns"),x.columnsKey="LetterDB.Letter",x.Fields=(0,E.fieldsProxy)();var C=x;var H=n(s(),1),K=n(A(),1);var l=class extends K.GridEditorBase{getColumnsKey(){return w.columnsKey}getDialogType(){return N}getLocalTextPrefix(){return G.localTextPrefix}};i(l,"LetterAttachmentEditor"),l=m([H.Decorators.registerEditor("CorrespondenceSystem.LetterAttachmentDB.LetterAttachmentEditor")],l);var c=n(s(),1),k=n(A(),1);var p=class extends k.GridEditorBase{getColumnsKey(){return b.columnsKey}getDialogType(){return U}getLocalTextPrefix(){return q.localTextPrefix}AddSign(){(0,c.serviceCall)({url:(0,c.resolveUrl)("~/Services/SignLettersDB/SignLetters/AddSignLetter"),onSuccess:a=>{var t=this.view.getItems();let e={SignTitle:a.Title,SignId:a.Id,CreatedDate:a.CreatedDate};var S=this.id(e);S==null&&(e[this.getIdProperty()]=this.getNextId()),t.push(e),this.setEntities(t)},method:"post"})}getButtons(){var a=super.getButtons(),t=(0,c.tryFirst)(a,e=>e.cssClass=="add-button");if(t){let e=!0;t.onClick=S=>{e&&(this.AddSign(),e=!1,t.disabled=!0)}}return a}};i(p,"SignLettersEditor"),p=m([c.Decorators.registerEditor("CorrespondenceSystem.SignLettersDB.SignLettersEditor")],p);var r=n(s(),1);var J=n(s(),1),B=(t=>(t[t.Normal=0]="Normal",t[t.Secret=1]="Secret",t))(B||{});J.Decorators.registerEnumType(B,"CorrespondenceSystem.Modules.Enums.Letter.ConfidentialLevels","ConfidentialLevels");var Q=n(s(),1),h=(t=>(t[t.Outgoing=0]="Outgoing",t[t.Incoming=1]="Incoming",t))(h||{});Q.Decorators.registerEnumType(h,"CorrespondenceSystem.Modules.Enums.Letter.LetterTypes","LetterTypes");var M=n(s(),1),P=(e=>(e[e.Urgent=0]="Urgent",e[e.Instant=1]="Instant",e[e.Normal=2]="Normal",e))(P||{});M.Decorators.registerEnumType(P,"CorrespondenceSystem.Modules.Enums.Letter.PriorityStates","PriorityState");var g=class g extends r.PrefixedContext{constructor(a){if(super(a),!g.init){g.init=!0;var t=r.RadioButtonEditor,e=r.StringEditor,S=r.EnumEditor,y=r.ServiceLookupEditor,R=r.BooleanEditor,z=r.LookupEditor,W=r.TextAreaEditor,Y=l,Z=p;(0,r.initFormType)(g,["LetterType",t,"Title",e,"LetterIdentifier",e,"LetterIdentifierGen",e,"LetterNo",e,"PriorityState",t,"ConfidentialLevel",t,"State",S,"SenderId",y,"ReceiverId",y,"GrandSubjectId",y,"UseDefaultTemplate",R,"TemplateId",z,"LetterContent",W,"Tag",e,"LetterCarrier",e,"HasAttachment",R,"NeedAnswer",R,"DetailList",Y,"SignLettersDetailList",Z])}}};i(g,"LetterForm"),g.formKey="LetterDB.Letter";var T=g;var X=n(s(),1);var d=class d{};i(d,"LetterRow"),d.idProperty="Id",d.nameProperty="LetterIdentifier",d.localTextPrefix="LetterDB.Letter",d.deletePermission="Administration:General",d.insertPermission="Administration:General",d.readPermission="Administration:General",d.updatePermission="Administration:General",d.Fields=(0,X.fieldsProxy)();var L=d;var F=n(s(),1),v;(t=>(t.baseUrl="LetterDB/Letter",t.Methods={Create:"LetterDB/Letter/Create",Update:"LetterDB/Letter/Update",Delete:"LetterDB/Letter/Delete",Retrieve:"LetterDB/Letter/Retrieve",List:"LetterDB/Letter/List",SetDefaultRecriverSender:"LetterDB/Letter/SetDefaultRecriverSender",SetDefaultTemplate:"LetterDB/Letter/SetDefaultTemplate"},["Create","Update","Delete","Retrieve","List","SetDefaultRecriverSender","SetDefaultTemplate"].forEach(e=>{t[e]=function(S,y,R){return(0,F.serviceRequest)(t.baseUrl+"/"+e,S,y,R)}})))(v||(v={}));var I=n(s(),1);var o=n(s(),1);var u=class extends o.EntityDialog{constructor(){super(...arguments);this.form=new T(this.idPrefix)}getFormKey(){return T.formKey}getRowDefinition(){return L}getService(){return v.baseUrl}afterLoadEntity(){this.SetRecriverSender(),this.SetDefaultTemplate(),this.form.LetterType.changeSelect2(t=>{this.form.LetterType.value===0 .toString()&&o.EditorUtils.setValue(this.form.State,0)})}SetRecriverSender(){(0,o.serviceCall)({url:(0,o.resolveUrl)("~/Services/LetterDB/Letter/SetDefaultRecriverSender"),onSuccess:t=>{t?this.form.LetterType.changeSelect2(e=>{if(this.form.LetterType.value==1 .toString()&&(o.EditorUtils.setValue(this.form.ReceiverId,t),o.EditorUtils.setValue(this.form.SenderId,null)),this.form.LetterType.value==0 .toString()){var S=this.SetRecriverSender();o.EditorUtils.setValue(this.form.SenderId,t),o.EditorUtils.setValue(this.form.ReceiverId,null)}}):console.error("Invalid response format for SetDefaultRecriverSender")},method:"post"})}SetDefaultTemplate(){(0,o.serviceCall)({url:(0,o.resolveUrl)("~/Services/LetterDB/Letter/SetDefaultTemplate"),onSuccess:t=>{this.form.LetterType.value==0 .toString()&&o.EditorUtils.setValue(this.form.TemplateId,t)},method:"post"})}};i(u,"LetterDialog"),u=m([o.Decorators.registerClass("CorrespondenceSystem.LetterDB.LetterDialog")],u);var f=class extends I.EntityGrid{getColumnsKey(){return C.columnsKey}getDialogType(){return u}getRowDefinition(){return L}getService(){return v.baseUrl}constructor(a){super(a)}};i(f,"LetterGrid"),f=m([I.Decorators.registerClass("CorrespondenceSystem.LetterDB.LetterGrid")],f);function _(){(0,V.initFullHeightGridPage)(new f($("#GridDiv")).element)}i(_,"pageInit");export{_ as default};
//# sourceMappingURL=LetterPage.js.map
